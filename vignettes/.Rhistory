geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_95_lb, ymax = pred_95_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_80_lb, ymax = pred_80_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_50_lb, ymax = pred_50_ub),
alpha = 0.2,
data = preds_df) +
geom_line(
mapping = aes(x = date_sick, y = pred_total_cases),
color = "royalblue",
size = 2,
data = preds_df) +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(aes(xintercept=as.numeric(data[c(13, 24)])),
linetype=4, colour="black") +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_95_lb, ymax = pred_95_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_80_lb, ymax = pred_80_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_50_lb, ymax = pred_50_ub),
alpha = 0.2,
data = preds_df) +
geom_line(
mapping = aes(x = date_sick, y = pred_total_cases),
color = "royalblue",
size = 2,
data = preds_df) +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[120]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_95_lb, ymax = pred_95_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_80_lb, ymax = pred_80_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_50_lb, ymax = pred_50_ub),
alpha = 0.2,
data = preds_df) +
geom_line(
mapping = aes(x = date_sick, y = pred_total_cases),
color = "royalblue",
size = 2,
data = preds_df) +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[128]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_95_lb, ymax = pred_95_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_80_lb, ymax = pred_80_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_50_lb, ymax = pred_50_ub),
alpha = 0.2,
data = preds_df) +
geom_line(
mapping = aes(x = date_sick, y = pred_total_cases),
color = "royalblue",
size = 2,
data = preds_df) +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[124]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_95_lb, ymax = pred_95_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_80_lb, ymax = pred_80_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_50_lb, ymax = pred_50_ub),
alpha = 0.2,
data = preds_df) +
geom_line(
mapping = aes(x = date_sick, y = pred_total_cases),
color = "royalblue",
size = 2,
data = preds_df) +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[122]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_95_lb, ymax = pred_95_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_80_lb, ymax = pred_80_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_50_lb, ymax = pred_50_ub),
alpha = 0.2,
data = preds_df) +
geom_line(
mapping = aes(x = date_sick, y = pred_total_cases),
color = "royalblue",
size = 2,
data = preds_df) +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[122]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_95_lb, ymax = pred_95_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_80_lb, ymax = pred_80_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_50_lb, ymax = pred_50_ub),
alpha = 0.2,
data = preds_df) +
geom_line(
mapping = aes(x = date_sick, y = pred_total_cases),
color = "royalblue",
size = 2,
data = preds_df) +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[122]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_95_lb, ymax = pred_95_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_80_lb, ymax = pred_80_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_50_lb, ymax = pred_50_ub),
alpha = 0.2,
data = preds_df) +
geom_line(
mapping = aes(x = date_sick, y = pred_total_cases),
color = "royalblue",
size = 2,
data = preds_df) +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[123]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[123]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- training_data %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[123]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[123]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[123]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years[0,123]) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[123]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years[:,123]) +
data_X_3years[0,123]
data_X_3years
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years[1:123]) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[123]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years[1:123,]) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[123]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili[1:123,]),
size=0.7,
data = data_X_3years) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[123]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years[1:123,]) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[123]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years[:123,]) +
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years[1:123,]) +
geom_vline(xintercept=as.numeric(data_X_3years$week_start[123]), linetype=4) +
xlab("") + ylab("Weighted ILI")
data_X_3years <- data2 %>% filter(year > 2013)
ggplot() +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_95_lb, ymax = pred_95_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_80_lb, ymax = pred_80_ub),
fill = "cornflowerblue",
alpha = 0.2,
data = preds_df) +
geom_ribbon(
mapping = aes(x = date_sick, ymin = pred_50_lb, ymax = pred_50_ub),
alpha = 0.2,
data = preds_df) +
geom_line(
mapping = aes(x = date_sick, y = pred_total_cases),
color = "royalblue",
size = 2,
data = preds_df) +
geom_line(mapping = aes(x = week_start, y = weighted_ili),
size=0.7,
data = data_X_3years) +
xlab("") + ylab("Weighted ILI")
head(testing_data,5)
# training data for province 10, years 2006 - 2012
library(ForecastFramework)
library(R6)
library(forecast)
library(dplyr)
library(ggplot2)
library(cdcfluview)
# Source R6 Files
library(RCurl)
# Function of Source Github Models
source_github <- function(u) {
script <- getURL(u, ssl.verifypeer = FALSE)
eval(parse(text = script),envir=.GlobalEnv)
}
# Source R6 Files
source_github('https://raw.githubusercontent.com/reichlab/forecast-framework-demos/master/models/ContestModel.R')
source_github('https://raw.githubusercontent.com/reichlab/forecast-framework-demos/master/models/SARIMATD1Model.R')
data2 <- ilinet(region = "National")
data2 <- data2 %>% filter( week != 53)
data2 <- data2 %>%
filter( year > 2009 &
year < 2018 &
!(year == 2017 & week > 18))
data2 <- data2 %>%
select('region','year','week','weighted_ili', 'week_start')
# Create a Preprocess Function
preprocess_inc <- function(dat){
dat$time.in.year = dat$week
dat$t = dat$year + dat$week/52
inc = ObservationList$new(dat)
inc$formArray('region','t',val='weighted_ili',
dimData = list(NULL,list('week','year','time.in.year','t')),
metaData = list(t.step = 1/52,max.year.time = 52))
return(inc)
}
# Seperate into Training and Testing Data
training_data <- data2 %>%
filter( ! ((year == 2016 & week >= 19)| (year == 2017 ) ))
testing_data <- data2 %>%
filter((year == 2016 & week >= 19) | (year == 2017 & week <= 18) )
training_inc <- preprocess_inc(training_data)
testing_inc <- preprocess_inc(testing_data)
# define how many provinces to model
# this demo only has data for one province: Province 10
nsim <- 1000 # Number of SARIMA simulations
sarimaTD_model <- SARIMATD1Model$new(period = 52, nsim = nsim)
prov_nums <- 1
nmodels <- length(prov_nums)
sarimaTD_model$fit(inc$subset(rows = prov_nums, mutate = FALSE))
# training data for province 10, years 2006 - 2012
library(ForecastFramework)
library(R6)
library(forecast)
library(dplyr)
library(ggplot2)
library(cdcfluview)
# Source R6 Files
library(RCurl)
# Function of Source Github Models
source_github <- function(u) {
script <- getURL(u, ssl.verifypeer = FALSE)
eval(parse(text = script),envir=.GlobalEnv)
}
# Source R6 Files
source_github('https://raw.githubusercontent.com/reichlab/forecast-framework-demos/master/models/ContestModel.R')
source_github('https://raw.githubusercontent.com/reichlab/forecast-framework-demos/master/models/SARIMATD1Model.R')
# Preprocess data to Inc Matrix
data2 <- ilinet(region = "National")
data2 <- data2 %>% filter( week != 53)
data2 <- data2 %>%
filter( year > 2009 &
year < 2018 &
!(year == 2017 & week > 18))
data2 <- data2 %>%
select('region','year','week','weighted_ili', 'week_start')
preprocess_inc <- function(dat){
dat$time.in.year = dat$week
dat$t = dat$year + dat$week/52
inc = ObservationList$new(dat)
inc$formArray('region','t',val='weighted_ili',
dimData = list(NULL,list('week','year','time.in.year','t')),
metaData = list(t.step = 1/52,max.year.time = 52))
return(inc)
}
training_data <- data2 %>%
filter( ! ((year == 2016 & week >= 19)| (year == 2017 ) ))
training_inc <- preprocess_inc(training_data)
# Create new SARIMATD model
nsim <- 1000 # Number of SARIMA simulations
sarimaTD_model <- SARIMATD1Model$new(period = 52, nsim = nsim)
# Fit SARIMATD model
sarimaTD_model$fit(training_data)
# training data for province 10, years 2006 - 2012
library(ForecastFramework)
library(R6)
library(forecast)
library(dplyr)
library(ggplot2)
library(cdcfluview)
# Source R6 Files
library(RCurl)
# Function of Source Github Models
source_github <- function(u) {
script <- getURL(u, ssl.verifypeer = FALSE)
eval(parse(text = script),envir=.GlobalEnv)
}
# Source R6 Files
source_github('https://raw.githubusercontent.com/reichlab/forecast-framework-demos/master/models/ContestModel.R')
source_github('https://raw.githubusercontent.com/reichlab/forecast-framework-demos/master/models/SARIMATD1Model.R')
# Preprocess data to Inc Matrix
data2 <- ilinet(region = "National")
data2 <- data2 %>% filter( week != 53)
data2 <- data2 %>%
filter( year > 2009 &
year < 2018 &
!(year == 2017 & week > 18))
data2 <- data2 %>%
select('region','year','week','weighted_ili', 'week_start')
preprocess_inc <- function(dat){
dat$time.in.year = dat$week
dat$t = dat$year + dat$week/52
inc = ObservationList$new(dat)
inc$formArray('region','t',val='weighted_ili',
dimData = list(NULL,list('week','year','time.in.year','t')),
metaData = list(t.step = 1/52,max.year.time = 52))
return(inc)
}
training_data <- data2 %>%
filter( ! ((year == 2016 & week >= 19)| (year == 2017 ) ))
training_inc <- preprocess_inc(training_data)
# Create new SARIMATD model
nsim <- 1000 # Number of SARIMA simulations
sarimaTD_model <- SARIMATD1Model$new(period = 52, nsim = nsim)
# Fit SARIMATD model
sarimaTD_model$fit(training_inc)
# Forecast SARIMATD Model
steps <- 52 # forecast ahead 26 biweeks
forecast_X <- sarimaTD_model$forecast(steps = steps)
print(forecast_X$data$mat)
install_github("Reichlab/sarimaTD")
devtools::install_github(reichlab/sarimaTD)
devtools::install_github("reichlab/sarimaTD")
install.packages('R6')
install.packages("R6")
install.packages("R6")
install.packages('devtools')
library(devtools)
install.packages('R6')
install.packages('forecast')
install.packages("R6")
install.packages("R6")
install.packages('devtools')
library(devtools)
install.packages('R6')
install.packages('forecast')
install.packages("R6")
install.packages('dplyr')
install.packages('ggplot2')
install.packages('gridExtra')
install.packages("dplyr")
install.packages("ggplot2")
install.packages('data.table')
install.packages("ggplot2")
install.packages('knitr')
install.packages('kableExtra')
install.packages('RCurl')
install.packages("knitr")
devtools::install_github('HopkinsIDD/ForecastFramework')
devtools::install_github('reichlab/sarimaTD')
devtools::install_github("hrbrmstr/cdcfluview")
devtools::install_github("hrbrmstr/cdcfluview")
install.packages("dplyr")
install.packages("dplyr")
devtools::install_github("hrbrmstr/cdcfluview")
install.packages(c('R6','devtools','forecast','dplyr','ggplot2','gridExtra','data.table','knitr','kableExtra','RCurl'))
library(devtools)
devtools::install_github('HopkinsIDD/ForecastFramework')
devtools::install_github('reichlab/sarimaTD')
devtools::install_github("hrbrmstr/cdcfluview")
install.packages(c("R6", "devtools", "forecast", "dplyr", "ggplot2", "gridExtra", "data.table", "knitr", "kableExtra", "RCurl"))
install.packages(c("R6", "devtools", "forecast", "dplyr", "ggplot2", "gridExtra", "data.table", "knitr", "kableExtra", "RCurl"))
install.packages(c("R6", "devtools", "forecast", "dplyr", "ggplot2", "gridExtra", "data.table", "knitr", "kableExtra", "RCurl"))
install.packages(c("R6", "devtools", "forecast", "dplyr", "ggplot2", "gridExtra", "data.table", "knitr", "kableExtra", "RCurl"))
install.packages(c("R6", "devtools", "forecast", "dplyr", "ggplot2", "gridExtra", "data.table", "knitr", "kableExtra", "RCurl"))
library(devtools)
devtools::install_github('HopkinsIDD/ForecastFramework')
devtools::install_github('reichlab/sarimaTD')
devtools::install_github("hrbrmstr/cdcfluview")
install.packages(c('R6','devtools','forecast','dplyr','ggplot2','gridExtra','data.table','knitr','kableExtra','RCurl'))
install.packages(c("R6", "devtools", "forecast", "dplyr", "ggplot2", "gridExtra", "data.table", "knitr", "kableExtra", "RCurl"))
install.packages('dplyr')
install.packages("dplyr")
install.packages('dplyr')
library(devtools)
devtools::install_github('HopkinsIDD/ForecastFramework')
devtools::install_github('reichlab/sarimaTD')
devtools::install_github("hrbrmstr/cdcfluview")
